---
import "../styles/global.css";
import Footer from "../components/Footer.astro";
import Navbar from "../components/Navbar.astro";
import { getPageTitle } from "../scripts/title.ts";
const title = getPageTitle(Astro.url.pathname);
const isProd = import.meta.env.PROD;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon-16x16.png" />
    <meta name="generator" content={Astro.generator} />
    <!-- Font Awesome 6 via CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />

    {isProd && (
      <>
        <!-- Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-E09XPHZJTL"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){{ dataLayer.push(arguments); }}
          gtag('js', new Date());
          gtag('config', 'G-E09XPHZJTL');
        </script>
      </>
    )}

    <title>{title}</title>
  </head>

  <body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-white">
    <Navbar />
    <main>
      <slot />
    </main>
    <Footer />

    <!-- Flowbite JS -->
    <script defer src="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.js"></script>

    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <!-- Toggle Tema -->
    <script src="/theme-toggle.js" defer></script>

    <!-- Sienna Accessibility Widget -->
    <script src="https://website-widgets.pages.dev/dist/sienna.min.js" defer></script>

    <!-- Back to Top Button -->
    <button id="backToTop" title="Kembali ke Atas"
      class="fixed z-[9999] bottom-4 right-4 bg-purple-700 hover:bg-purple-800 text-white rounded-full p-3 shadow-lg hidden transition-opacity duration-300"
    >
      <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 384 512">
        <path d="M214.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-160 160c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 141.2V448c0 17.7 14.3 32 32 32s32-14.3 32-32V141.2L329.4 246.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-160-160z"/>
      </svg>
    </button>

    <!-- Back to Top Script -->
    <script>
      const btn = document.getElementById('backToTop');
      window.addEventListener('scroll', () => {
        if (window.scrollY > 300) {
          btn.classList.remove('hidden');
          btn.classList.add('opacity-100');
        } else {
          btn.classList.add('hidden');
        }
      });
      btn.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });
    </script>
  </body>
</html>

<style>
  html,
  body {
    margin: 0;
    width: 100%;
    height: 100%;
  }
</style>
